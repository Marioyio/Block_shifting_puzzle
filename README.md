# 方块解谜游戏

一个基于Python和Pygame的图形界面方块解谜游戏。

## 功能特性

- 图形化用户界面
- 多关卡系统（大关-小关结构）
- 方块选择和拖拽操作
- 多种限制条件（胶水、镜子等）
- 撤销/重做功能
- 关卡进度保存

## 游戏规则

1. **选择方块阶段**：用鼠标点击或拖拽选择方块，选中的方块会显示绿色半透明效果
2. **限制检查**：确认选择后，系统会检查是否满足关卡限制条件
3. **移动阶段**：满足选择限制后，可以拖拽选中的方块进行移动
4. **最终检查**：移动完成后，检查是否满足最终图形限制

## 限制条件

- **胶水**：选中的方块需要是连通的
- **镜子**：最终图形需要是轴对称图形

## 安装和运行

### 环境要求
- Python 3.7+
- Pygame 2.0+

### 安装步骤

1. 安装依赖：
```bash
pip install -r requirements.txt
```

2. 运行游戏：
```bash
python main.py
```

## 文件结构

```
blocks/
├── main.py              # 主程序入口
├── game.py              # 主游戏逻辑
├── ui.py                # 用户界面
├── block.py             # 方块对象
├── blockset.py          # 方块集合
├── level_parser.py      # 关卡解析器
├── constraints.py       # 限制条件检查
├── levels.txt           # 关卡数据
├── requirements.txt     # 依赖管理
└── README.md           # 说明文档
```

## 关卡文件格式

关卡文件`levels.txt`的格式如下：

```
scope=1; scope_name='大关名称'; total_levels=关卡数量;
begin level 1
limit 限制条件名称
block{type=方块类型,pos=(x,y)}
...
end level 1
```

## 操作说明

- **鼠标左键**：选择方块、拖拽选择区域
- **重置按钮**：重置当前关卡
- **撤销按钮**：撤销上一步操作
- **重做按钮**：重做上一步撤销
- **确认按钮**：确认当前选择

## 开发说明

游戏采用面向对象设计，各模块职责明确：
- `Block`：单个方块对象
- `BlockSet`：方块集合管理
- `UI`：用户界面和交互
- `Game`：主游戏逻辑
- `LevelParser`：关卡数据解析
- `ConstraintChecker`：限制条件检查

每个文件都控制在400行以内，便于维护和扩展。 